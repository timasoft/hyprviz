{{< callout type=warning >}}

Правила окон **чувствительны к регистру**. (например, `firefox` ≠ `Firefox`)

Начиная с Hyprland v0.46.0, регулярные выражения должны полностью соответствовать значениям окна. Для
примера, в случае с `kitty`:

- `kitty`/`(kitty)`/`^(kitty)$`: Соответствует.
- `tty`: Раньше соответствовало, теперь не будет. Используйте `.*tty.*`, чтобы сделать как раньше, или
  рассмотрите использование более конкретного регулярного выражения.

{{< /callout >}}

{{< callout type=warning >}}

Правила оцениваются сверху вниз, поэтому порядок их написания имеет значение!
Дополнительная информация в разделе [Примечания](#примечания)

{{< /callout >}}

## Правила окон

Вы можете устанавливать правила окон для достижения различных поведений окон на основе их свойств.

### Синтаксис

```ini
windowrule=ПРАВИЛО,ПАРАМЕТРЫ
```

- `ПРАВИЛО` - это [правило](#правила) (и параметр, если применимо)
- `ПАРАМЕТРЫ` - это список различных атрибутов окна, по которым можно сопоставлять, разделенных запятыми. См. поля ниже.

Пример правила:
```ini
windowrule = float, class:kitty, title:kitty
```

Несколько правил могут быть указаны в одной строке, разделенные запятыми. Но должны сопровождаться хотя бы одним параметром.

Пример:
```ini
windowrule = float, pin, size 400 400, move 0 0, class:kitty, initialTitle:kitty
```
Где float, pin, size и move - это `ПРАВИЛА`, а class и initialTitle - это `ПАРАМЕТРЫ`.

{{< callout type=info >}}

В случае динамических заголовков окон, таких как окна браузера, помните, насколько мощными являются регулярные выражения.

Например, правило окна:
`windowrule = opacity 0.3 override 0.3 override,title:(.*)(- Youtube)` будет соответствовать
_ЛЮБОМУ_ окну, которое содержит строку "- Youtube" после любого другого текста. Это
может быть несколько окон браузера или другие приложения, которые содержат строку
по любой причине.

Для примера `windowrule = float,class:kitty,title:kitty` поле
`class:(kitty)` для `WINDOW` - это то, что делает правило окна специфичным для терминалов kitty.

{{< /callout >}}

Поддерживаемые поля для параметров:

| Поле | Описание |
| -------------- | --------------- |
| class:[RegEx] | Окна с `class`, соответствующим `RegEx`. |
| title:[RegEx] | Окна с `title`, соответствующим `RegEx`. |
| initialClass:[RegEx] | Окна с `initialClass`, соответствующим `RegEx`. |
| initialTitle:[RegEx] | Окна с `initialTitle`, соответствующим `RegEx`. |
| tag:[name] | Окна с соответствующим `tag`. |
| xwayland:[0/1] | Окна Xwayland. |
| floating:[0/1] | Плавающие окна. |
| fullscreen:[0/1] | Полноэкранные окна. |
| pinned:[0/1] | Закрепленные окна. |
| focus:[0/1] | Текущее активное окно. |
| group:[0/1] | Группированные окна. |
| fullscreenstate:[internal] [client] | Окна с соответствующим `fullscreenstate`. `internal` и `client` могут быть `*` - любой, `0` - нет, `1` - максимизация, `2` - полноэкранный режим, `3` - максимизация и полноэкранный режим. |
| workspace:[w] | Окна на соответствующем рабочем пространстве. `w` может быть `id` или `name:string`. |
| onworkspace:[w] | Окна на соответствующем рабочем пространстве. `w` может быть `id`, `name:string` или `workspace selector`. |
| content:[none|photo|video|game] | Окна с указанным типом контента |
| xdgtag:[string] | Сопоставление окна по его xdgTag (см. `hyprctl clients`, чтобы проверить, есть ли он) |

Имейте в виду, что вы _должны_ объявить хотя бы одно поле, но не все.

{{< callout type=info >}}

Чтобы получить больше информации о классе окна, заголовке, статусе XWayland или его
размере, вы можете использовать `hyprctl clients`.

{{< /callout >}}

{{< callout type=info >}}

В выводе команды `hyprctl clients`:
`fullscreen` относится к `fullscreenstate.internal`, а
`fullscreenClient` относится к `fullscreenstate.client`

{{< /callout >}}

### Написание регулярных выражений

Обратите внимание, что Hyprland использует [Google's RE2](https://github.com/google/re2) для разбора регулярных выражений. Это означает, что все операции, требующие полиномиального
времени для вычисления, не будут работать. См. [RE2 wiki](https://github.com/google/re2/wiki/Syntax) для поддерживаемых расширений.

Если вы хотите _отрицать_ регулярное выражение, то есть пропускать только когда регулярное выражение _не соответствует_, вы можете добавить префикс `negative:`, например: `negative:kitty`.

## Правила

### Статические правила

Статические правила оцениваются один раз при открытии окна и больше никогда. Это по сути означает, что это всегда будет `initialTitle` и `initialClass`, которые будут найдены при сопоставлении по `title` и `class` соответственно.

{{< callout type=warning >}}

Невозможно применить `float` (или любое другое статическое правило) к окну на основе изменения `title` после создания окна. Это относится ко всем статическим правилам, перечисленным здесь.

{{< /callout >}}

| Правило | Описание |
| ---- | ----------- |
| float | Переводит окно в плавающий режим. |
| tile | Переводит окно в плиточный режим. |
| fullscreen | Переводит окно в полноэкранный режим. |
| maximize | Максимизирует окно. |
| persistentsize | Позволяет сохранять размер между запусками приложения для плавающих окон. |
| fullscreenstate [internal] [client] | Устанавливает полноэкранный режим окна и тот, который отправляется клиенту, где internal и client могут быть `0` - нет, `1` - максимизация, `2` - полноэкранный режим, `3` - максимизация и полноэкранный режим. |
| move [x] [y] | Перемещает плавающее окно (`x, y` -> целое число или %, например `100` или `20%`.<br>Вы также можете использовать `100%-` для привязки к правому/нижнему краю, например `100%-20`. Кроме того, опция поддерживает вычитание размера окна с помощью `100%-w-`, например `100%-w-20`. Это приводит к появлению отступа от правого/нижнего края экрана до окна с определенным вычитаемым размером). <br>Кроме того, вы также можете использовать `cursor [x] [y]`, где x и y - это либо пиксели, либо проценты. Процент рассчитывается от размера окна. Укажите `onscreen` перед другими параметрами, чтобы принудительно поместить окно на экран (например, `move onscreen cursor 50% 50%`) |
| size [w] [h] | Изменяет размер плавающего окна (`w, h` -> целое число или %, например `1280, 720` или `50%, 50%`.<br>`<` и `>` также могут быть указаны в сочетании, чтобы указать соответственно максимальный или минимальный допустимый размер. (например, `<1280` или `<40%` -> максимальный размер, `>300` или `>10%` -> минимальный размер).<br>Обратите внимание, что целочисленные значения в пикселях будут масштабироваться с учетом коэффициента масштабирования вашего монитора. |
| center ([opt]) | Если окно плавающее, центрирует его на мониторе. Установите opt в `1`, чтобы учитывать зарезервированную область монитора. |
| pseudo | Переводит окно в псевдо-режим. |
| monitor [id] | Устанавливает монитор, на котором должно открываться окно. `id` может быть либо номером идентификатора, либо именем (например, `1` или `DP-1`). |
| workspace [w] | Устанавливает рабочее пространство, на котором должно открываться окно (для синтаксиса рабочего пространства см. [dispatchers->workspaces](../Dispatchers#workspaces)). <br> Вы также можете установить [w] в `unset`. Это отменит все предыдущие правила рабочего пространства, примененные к этому окну. Кроме того, вы можете добавить `silent` после рабочего пространства, чтобы окно открывалось без переключения. |
| noinitialfocus | Отключает начальный фокус на окне |
| pin | Закрепляет окно (то есть показывает его на всех рабочих пространствах). _Примечание: только для плавающих окон_. |
| unset [rule] | Отменяет правила для соответствующих `ПАРАМЕТРОВ` (требуется точное совпадение) или конкретного `ПРАВИЛА`. По умолчанию правило `all`. |
| nomaxsize | Удаляет ограничения максимального размера. Особенно полезно с окнами, которые сообщают недействительные максимальные размеры (например, winecfg). |
| stayfocused | Принудительно сохраняет фокус на окне, пока оно видимо. |
| group [options] | Устанавливает свойства группы окон. См. примечание ниже. |
| suppressevent [types...] | Игнорирует определенные события от окна. События разделены пробелом и могут быть: `fullscreen`, `maximize`, `activate`, `activatefocus`, `fullscreenoutput`. |
| content [none|photo|video|game] | Устанавливает тип контента. |
| noclosefor [ms] | Делает окно недоступным для закрытия с помощью диспетчера `killactive` в течение заданного количества миллисекунд при открытии. |

### Динамические правила

Динамические правила переоцениваются каждый раз, когда изменяется свойство.

| Правило | Описание |
| ---- | ----------- |
| animation [style] ([opt]) | Принудительно применяет анимацию к окну с выбранным opt. Opt необязательный. |
| bordercolor [c] | Принудительно устанавливает цвет границы окна. <br> Варианты для c: `color`/`color ... color angle` -> устанавливает активный цвет/градиент границы ИЛИ `color color`/`color ... color angle color ... color [angle]` -> устанавливает активный и неактивный цвет/градиент границы окна. См. [variables->colors](../Variables#variable-types) для определения цвета. |
| idleinhibit [mode] | Устанавливает правило подавления бездействия для окна. Если активно, приложения вроде `hypridle` не будут срабатывать. Режимы: `none`, `always`, `focus`, `fullscreen`. |
| opacity [a] | Дополнительный множитель прозрачности. Варианты для a: `float` -> устанавливает общую прозрачность, `float float` -> устанавливает activeopacity и inactiveopacity соответственно, `float float float` -> устанавливает activeopacity, inactiveopacity и fullscreenopacity соответственно. |
| tag [name] | Применяет тег `name` к окну, используйте префикс `+`/`-` для установки/снятия флага, или без префикса для переключения флага. |
| maxsize [w] [h] | Устанавливает максимальный размер (x,y -> целое число). |
| minsize [w] [h] | Устанавливает минимальный размер (x,y -> целое число).|

Следующие правила также могут быть установлены с помощью [`setprop`](../Dispatchers#setprop):

| Правило | Описание |
| ---- | ----------- |
| bordersize [int] | Устанавливает размер границы. |
| rounding [int] | Принудительно устанавливает X пикселей скругления для приложения, игнорируя установленное по умолчанию (в `decoration:rounding`). Должно быть целым числом. |
| roundingpower [float] | Переопределяет силу скругления для окна (см. `decoration:rounding_power`). |
| allowsinput [on] | Принудительно заставляет окно XWayland получать ввод, даже если оно запрашивает не делать этого. (Может исправить проблемы, например, когда игровые лаунчеры по какой-то причине не получают фокус) |
| dimaround [on] | Затемняет все вокруг окна. Обратите внимание, что это правило предназначено для плавающих окон, и его использование на плиточных окнах может привести к странному поведению. |
| decorate [on] | Рисовать ли декорации окна или нет |
| focusonactivate [on] | Должен ли Hyprland фокусироваться на приложении, которое запрашивает фокус (запрос `activate`). |
| keepaspectratio [on] | Сохраняет соотношение сторон при изменении размера окна с помощью мыши. |
| nearestneighbor [on] | Принудительно заставляет окно использовать [ближайший сосед](https://en.wikipedia.org/wiki/Image_scaling#Nearest-neighbor_interpolation) фильтрацию. |
| noanim [on] | Отключает анимации для окна. |
| noblur [on] | Отключает размытие для окна. |
| noborder [on] | Отключает границы для окна. |
| nodim [on] | Отключает затемнение окна. |
| nofocus [on] | Отключает фокус для окна. |
| nofollowmouse [on] | Предотвращает фокусировку окна при перемещении мыши над ним, когда установлено `input:follow_mouse=1`. |
| nomaxsize [on] | Отключает максимальный размер для окна. |
| norounding [on] | Отключает скругление для окна. |
| noshadow [on] | Отключает тени для окна. |
| noshortcutsinhibit [on] | Запрещает приложению [подавлять ваши сочетания клавиш](https://wayland.app/protocols/keyboard-shortcuts-inhibit-unstable-v1). |
| opaque [on] | Принудительно делает окно непрозрачным. |
| forcergbx [on] | Принудительно заставляет Hyprland игнорировать альфа-канал на всех поверхностях окна, фактически делая его _действительно, полностью 100% непрозрачным_. |
| syncfullscreen [on] | Должен ли полноэкранный режим всегда совпадать с тем, который отправляется окну (вступит в силу только при следующем изменении полноэкранного режима). |
| immediate [on] | Принудительно разрешает окну разрыв. См. [страницу Разрывов](../Tearing). |
| xray [on] | Устанавливает режим рентгена для размытия окна. |
| renderunfocused | Принудительно заставляет окно думать, что оно отрисовывается, когда оно не видимо. См. также [Variables - Misc](../Variables/#Misc) для установки `render_unfocused_fps`. |
| scrollmouse [float] | Принудительно заставляет окно переопределять переменную `input:scroll_factor`. |
| scrolltouchpad [float] | Принудительно заставляет окно переопределять переменную `input:touchpad:scroll_factor`. |
| noscreenshare [on] | Скрывает окно и его всплывающие окна от демонстрации экрана, рисуя черные прямоугольники на их месте. Прямоугольники рисуются даже если другие окна находятся сверху. |
| novrr [on] | Отключает VRR для окна. Работает только когда [`misc:vrr`](../Variables/#Misc) установлено в `2` или `3`. |

{{< callout type=info >}}

При использовании правил окон, [on] можно установить в `0` для _отключено_, `1` для _включено_, или оставить пустым для использования значения по умолчанию.

При использовании `setprop`, [on] можно установить в `0` для _отключено_, `1` для _включено_,
`toggle` для переключения состояния или `unset` для сброса предыдущих значений.

При использовании `setprop`, [int] также может быть `unset` для сброса предыдущих
значений.

{{< /callout >}}

### Опции правила `group` для окон

- `set` [`always`] - Открывать окно как группу.
- `new` - Сокращение для `barred set`.
- `lock` [`always`] - Заблокировать группу, в которую добавлено это окно. Используйте с `set` или
  `new` (например, `new lock`) для создания новой заблокированной группы.
- `barred` - Не группировать окно автоматически в активную незаблокированную группу.
- `deny` - Не разрешать окну быть переключенным как или добавленным в группу (см. диспетчер `denywindowfromgroup`).
- `invade` - Принудительно открывать окно в заблокированной группе.
- `override` [другие опции] - Переопределять другие правила `group`, например. Вы можете сделать все окна на определенном рабочем пространстве открываемыми как группа, и использовать `group override barred`, чтобы окна с определенными заголовками открывались как обычные окна.
- `unset` - Очистить все правила `group`.

{{< callout type=info >}}

Правило `group` без опций является сокращением для `group set`.

По умолчанию `set` и `lock` влияют на новые окна только один раз. Квалификатор `always` делает их всегда эффективными.

{{< /callout >}}

### Теги

Окна могут иметь несколько тегов, как статических, так и динамических. Динамические теги будут иметь суффикс `*`.
Вы можете проверить теги окна с помощью `hyprctl clients`.

Используйте диспетчер `tagwindow`, чтобы добавить статический тег к окну:

```bash
hyprctl dispatch tagwindow +code     # Добавить тег к текущему окну.
hyprctl dispatch tagwindow -- -code  # Удалить тег из текущего окна (используйте `--` для защиты ведущего `-`).
hyprctl dispatch tagwindow code      # Переключить тег текущего окна.

# Или вы можете пометить окна, соответствующие регулярному выражению окна:
hyprctl dispatch tagwindow +music deadbeef
hyprctl dispatch tagwindow +media title:Celluloid
```

Используйте правило `tag`, чтобы добавить динамический тег к окну:

```ini
windowrule = tag +term, class:footclient  # Добавить динамический тег `term*` к окну footclient.
windowrule = tag term, class:footclient   # Переключить динамический тег `term*` для окна footclient.
windowrule = tag +code, tag:cpp           # Добавить динамический тег `code*` к окну с тегом `cpp`.

windowrule = opacity 0.8, tag:code        # Установить прозрачность для окна с тегом `code` или `code*`.
windowrule = opacity 0.7, tag:cpp         # Окно с тегом `cpp` будет соответствовать как `code`, так и `cpp`, последнее будет переопределять предыдущее совпадение.
windowrule = opacity 0.6, tag:term*       # Установить прозрачность для окна с тегом `term*` только, `term` не будет соответствовать.

windowrule = tag -code, tag:term          # Удалить динамический тег `code*` для окна с тегом `term` или `term*`.
```

Или с помощью привязки клавиш для удобства:

```ini
bind = $mod Ctrl, 2, tagwindow, alpha_0.2
bind = $mod Ctrl, 4, tagwindow, alpha_0.4

windowrule = opacity 0.2 override, tag:alpha_0.2
windowrule = opacity 0.4 override, tag:alpha_0.4
```

Правило `tag` может манипулировать только динамическими тегами, а диспетчер `tagwindow` работает только со статическими тегами (то есть после вызова диспетчера динамические теги будут очищены).

### Примеры правил

```ini
windowrule = move 100 100, class:kitty                                    # Переместить kitty в 100 100
windowrule = animation popin, class:kitty                                 # Установить стиль анимации для kitty
windowrule = noblur, class:firefox                                        # Отключить размытие для firefox
windowrule = move cursor -50% -50%, class:kitty                           # Переместить kitty в центр курсора
windowrule = bordercolor rgb(FF0000) rgb(880808), fullscreen:1            # Установить цвет границы в красный, если окно полноэкранное
windowrule = bordercolor rgb(00FF00), fullscreenstate:* 1                 # Установить цвет границы в зеленый, если клиентское состояние полноэкранного режима окна равно 1(максимизация) (внутреннее состояние может быть любым)
windowrule = bordercolor rgb(FFFF00), title:.*Hyprland.*                  # Установить цвет границы в желтый, когда заголовок содержит Hyprland
windowrule = opacity 1.0 override 0.5 override 0.8 override, class:kitty  # Установить прозрачность 1.0 активная, 0.5 неактивная и 0.8 полноэкранная для kitty
windowrule = rounding 10, class:kitty                                     # Установить скругление в 10 для kitty
windowrule = stayfocused,  class:(pinentry-)(.*)                          # Исправить потерю фокуса pinentry
```

### Примечания

Правила, отмеченные как _Динамические_, будут переоцениваться, если изменится соответствующее свойство окна.<br>
Например, если определено правило, которое изменяет `bordercolor` окна, когда оно плавающее, то `bordercolor` изменится на запрошенный цвет, когда оно установлено в плавающее, и вернется к цвету по умолчанию, когда оно снова будет плиточным.

Правила будут обрабатываться сверху вниз, где ПОСЛЕДНЕЕ совпадение будет иметь приоритет. т.е.

```ini
windowrule = opacity 0.8 0.8, class:kitty
windowrule = opacity 0.5 0.5, floating:1
```

Здесь все неполноэкранные окна kitty будут иметь `opacity 0.8`, кроме если они плавающие. В противном случае у них будет `opacity 0.5`. Остальные неполноэкранные плавающие окна будут иметь `opacity 0.5`.

```ini
windowrule = opacity 0.5 0.5,floating:1
windowrule = opacity 0.8 0.8,class:kitty
```

Здесь все окна kitty будут иметь `opacity 0.8`, даже если они плавающие.
Остальные плавающие окна будут иметь `opacity 0.5`.

{{< callout type=info >}}

Прозрачность по умолчанию является ПРОИЗВЕДЕНИЕМ всех прозрачностей. Например, установка
`activeopacity` в `0.5` и `opacity` в `0.5` приведет к общей прозрачности
`0.25`. <br>
Вы можете установить прозрачности больше `1.0`, но любое произведение прозрачностей больше `1.0`
вызовет графические артефакты. <br>
Например, использование `0.5 * 2 = 1` нормально, но `0.5 * 4 = 2` вызовет графические артефакты. <br>
Вы можете поместить `override` после значения прозрачности, чтобы переопределить его на точное значение
вместо множителя.
Например, чтобы установить активную и неактивную прозрачность в 0.8 и сделать полноэкранные окна
полностью непрозрачными независимо от других правил прозрачности:

```ini
windowrule = opacity 0.8 override 0.8 override 1.0 override, class:kitty
```

{{< /callout >}}
